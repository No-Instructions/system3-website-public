var dt=Object.defineProperty;var ft=(n,e,t)=>e in n?dt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var _=(n,e,t)=>ft(n,typeof e!="symbol"?e+"":e,t);import{s as ee,l as pt,u as ht,m as _t,o as gt,D as Se,k as Pe,z as N,E as bt,a4 as x,d as B,i as O,P as E,Z as mt,T as Y,U as He,Y as wt,n as J,a as De,f as Me,t as Te,y as U}from"./scheduler.D_DiFEDa.js";import{S as te,i as se,t as C,a as k,d as $,g as K,f as L,b as P,m as H,c as V,h as Be}from"./index.uqldPLAT.js";import{e as ke}from"./each.8prNeyls.js";import{g as Q,a as X}from"./spread.CgU5AtxT.js";import{d as w,r as G,w as S}from"./index.BUY9SMGD.js";const Oe=n=>{const e=Object.entries(n),t=e.map(([s])=>s);return w(e.map(([,s])=>s),s=>Object.fromEntries(s.map((r,i)=>[t[i],r])))},Rt=n=>n&1,yt=n=>({}),Ce=n=>({...n[0]});function Ft(n){let e;const t=n[3].default,s=pt(t,n,n[2],Ce);return{c(){s&&s.c()},l(r){s&&s.l(r)},m(r,i){s&&s.m(r,i),e=!0},p(r,[i]){s&&s.p&&(!e||i&5)&&ht(s,t,r,r[2],Rt(i)||!e?_t(r[2]):gt(t,r[2],i,yt),Ce)},i(r){e||(k(s,r),e=!0)},o(r){C(s,r),e=!1},d(r){s&&s.d(r)}}}function vt(n,e,t){const s=[];let r=Se(e,s),i,{$$slots:l={},$$scope:o}=e;const a=Oe(r);return Pe(n,a,c=>t(0,i=c)),n.$$set=c=>{e=N(N({},e),bt(c)),t(4,r=Se(e,s)),"$$scope"in c&&t(2,o=c.$$scope)},[i,a,o,l]}class St extends te{constructor(e){super(),se(this,e,vt,Ft,ee,{})}}function Ie(n,e,t){const s=n.slice();return s[5]=e[t],s}function kt(n){let e,t,s;const r=[n[2]??{}];var i=n[1].component;function l(o,a){let c={$$slots:{default:[It]},$$scope:{ctx:o}};for(let u=0;u<r.length;u+=1)c=N(c,r[u]);return a!==void 0&&a&4&&(c=N(c,Q(r,[X(o[2]??{})]))),{props:c}}return i&&(e=x(i,l(n)),n[4](e)),{c(){e&&P(e.$$.fragment),t=E()},l(o){e&&V(e.$$.fragment,o),t=E()},m(o,a){e&&H(e,o,a),O(o,t,a),s=!0},p(o,a){if(a&2&&i!==(i=o[1].component)){if(e){K();const c=e;C(c.$$.fragment,1,0,()=>{$(c,1)}),L()}i?(e=x(i,l(o,a)),o[4](e),P(e.$$.fragment),k(e.$$.fragment,1),H(e,t.parentNode,t)):e=null}else if(i){const c=a&4?Q(r,[X(o[2]??{})]):{};a&258&&(c.$$scope={dirty:a,ctx:o}),e.$set(c)}},i(o){s||(e&&k(e.$$.fragment,o),s=!0)},o(o){e&&C(e.$$.fragment,o),s=!1},d(o){o&&B(t),n[4](null),e&&$(e,o)}}}function Ct(n){let e,t,s;const r=[n[2]??{}];var i=n[1].component;function l(o,a){let c={};for(let u=0;u<r.length;u+=1)c=N(c,r[u]);return a!==void 0&&a&4&&(c=N(c,Q(r,[X(o[2]??{})]))),{props:c}}return i&&(e=x(i,l(n)),n[3](e)),{c(){e&&P(e.$$.fragment),t=E()},l(o){e&&V(e.$$.fragment,o),t=E()},m(o,a){e&&H(e,o,a),O(o,t,a),s=!0},p(o,a){if(a&2&&i!==(i=o[1].component)){if(e){K();const c=e;C(c.$$.fragment,1,0,()=>{$(c,1)}),L()}i?(e=x(i,l(o,a)),o[3](e),P(e.$$.fragment),k(e.$$.fragment,1),H(e,t.parentNode,t)):e=null}else if(i){const c=a&4?Q(r,[X(o[2]??{})]):{};e.$set(c)}},i(o){s||(e&&k(e.$$.fragment,o),s=!0)},o(o){e&&C(e.$$.fragment,o),s=!1},d(o){o&&B(t),n[3](null),e&&$(e,o)}}}function Ae(n){let e,t;return e=new Nt({props:{of:n[5]}}),{c(){P(e.$$.fragment)},l(s){V(e.$$.fragment,s)},m(s,r){H(e,s,r),t=!0},p(s,r){const i={};r&2&&(i.of=s[5]),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){C(e.$$.fragment,s),t=!1},d(s){$(e,s)}}}function It(n){let e,t,s=ke(n[1].children),r=[];for(let l=0;l<s.length;l+=1)r[l]=Ae(Ie(n,s,l));const i=l=>C(r[l],1,1,()=>{r[l]=null});return{c(){for(let l=0;l<r.length;l+=1)r[l].c();e=E()},l(l){for(let o=0;o<r.length;o+=1)r[o].l(l);e=E()},m(l,o){for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(l,o);O(l,e,o),t=!0},p(l,o){if(o&2){s=ke(l[1].children);let a;for(a=0;a<s.length;a+=1){const c=Ie(l,s,a);r[a]?(r[a].p(c,o),k(r[a],1)):(r[a]=Ae(c),r[a].c(),k(r[a],1),r[a].m(e.parentNode,e))}for(K(),a=s.length;a<r.length;a+=1)i(a);L()}},i(l){if(!t){for(let o=0;o<s.length;o+=1)k(r[o]);t=!0}},o(l){r=r.filter(Boolean);for(let o=0;o<r.length;o+=1)C(r[o]);t=!1},d(l){l&&B(e),mt(r,l)}}}function At(n){let e,t,s,r;const i=[Ct,kt],l=[];function o(a,c){return a[1].children.length===0?0:1}return e=o(n),t=l[e]=i[e](n),{c(){t.c(),s=E()},l(a){t.l(a),s=E()},m(a,c){l[e].m(a,c),O(a,s,c),r=!0},p(a,[c]){let u=e;e=o(a),e===u?l[e].p(a,c):(K(),C(l[u],1,1,()=>{l[u]=null}),L(),t=l[e],t?t.p(a,c):(t=l[e]=i[e](a),t.c()),k(t,1),t.m(s.parentNode,s))},i(a){r||(k(t),r=!0)},o(a){C(t),r=!1},d(a){a&&B(s),l[e].d(a)}}}function Et(n,e,t){let{instance:s=void 0}=e,{config:r}=e,{props:i=void 0}=e;function l(a){Y[a?"unshift":"push"](()=>{s=a,t(0,s)})}function o(a){Y[a?"unshift":"push"](()=>{s=a,t(0,s)})}return n.$$set=a=>{"instance"in a&&t(0,s=a.instance),"config"in a&&t(1,r=a.config),"props"in a&&t(2,i=a.props)},[s,r,i,l,o]}class Ve extends te{constructor(e){super(),se(this,e,Et,At,ee,{instance:0,config:1,props:2})}}const _e=n=>(n==null?void 0:n.subscribe)instanceof Function,jt=G(void 0);function $t(n){let e,t,s;function r(l){n[3](l)}let i={config:n[0],props:n[0].props};return n[1]!==void 0&&(i.instance=n[1]),e=new Ve({props:i}),Y.push(()=>Be(e,"instance",r)),{c(){P(e.$$.fragment)},l(l){V(e.$$.fragment,l)},m(l,o){H(e,l,o),s=!0},p(l,o){const a={};o&1&&(a.config=l[0]),o&1&&(a.props=l[0].props),!t&&o&2&&(t=!0,a.instance=l[1],He(()=>t=!1)),e.$set(a)},i(l){s||(k(e.$$.fragment,l),s=!0)},o(l){C(e.$$.fragment,l),s=!1},d(l){$(e,l)}}}function Pt(n){let e,t;return e=new St({props:{props:n[0].props,$$slots:{default:[Ht,({props:s})=>({4:s}),({props:s})=>s?16:0]},$$scope:{ctx:n}}}),{c(){P(e.$$.fragment)},l(s){V(e.$$.fragment,s)},m(s,r){H(e,s,r),t=!0},p(s,r){const i={};r&1&&(i.props=s[0].props),r&51&&(i.$$scope={dirty:r,ctx:s}),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){C(e.$$.fragment,s),t=!1},d(s){$(e,s)}}}function Ht(n){let e,t,s;function r(l){n[2](l)}let i={config:n[0],props:n[4]};return n[1]!==void 0&&(i.instance=n[1]),e=new Ve({props:i}),Y.push(()=>Be(e,"instance",r)),{c(){P(e.$$.fragment)},l(l){V(e.$$.fragment,l)},m(l,o){H(e,l,o),s=!0},p(l,o){const a={};o&1&&(a.config=l[0]),o&16&&(a.props=l[4]),!t&&o&2&&(t=!0,a.instance=l[1],He(()=>t=!1)),e.$set(a)},i(l){s||(k(e.$$.fragment,l),s=!0)},o(l){C(e.$$.fragment,l),s=!1},d(l){$(e,l)}}}function Dt(n){let e,t,s,r,i;const l=[Pt,$t],o=[];function a(c,u){return u&1&&(e=null),e==null&&(e=!!_e(c[0].props)),e?0:1}return t=a(n,-1),s=o[t]=l[t](n),{c(){s.c(),r=E()},l(c){s.l(c),r=E()},m(c,u){o[t].m(c,u),O(c,r,u),i=!0},p(c,[u]){let d=t;t=a(c,u),t===d?o[t].p(c,u):(K(),C(o[d],1,1,()=>{o[d]=null}),L(),s=o[t],s?s.p(c,u):(s=o[t]=l[t](c),s.c()),k(s,1),s.m(r.parentNode,r))},i(c){i||(k(s),i=!0)},o(c){C(s),i=!1},d(c){c&&B(r),o[t].d(c)}}}function Mt(n,e,t){let{config:s}=e,r;wt(function(){return s.eventHandlers.forEach(([a,c])=>{const u=r.$$.callbacks[a]??[];u.push(c),t(1,r.$$.callbacks[a]=u,r)}),function(){s.eventHandlers.forEach(([c,u])=>{const d=r.$$.callbacks[c],m=d.findIndex(p=>p===u);d.splice(m,1)})}});function i(o){r=o,t(1,r)}function l(o){r=o,t(1,r)}return n.$$set=o=>{"config"in o&&t(0,s=o.config)},[s,r,i,l]}class Tt extends te{constructor(e){super(),se(this,e,Mt,Dt,ee,{config:0})}}function Bt(n){let e,t;return e=new Tt({props:{config:n[0]}}),{c(){P(e.$$.fragment)},l(s){V(e.$$.fragment,s)},m(s,r){H(e,s,r),t=!0},p(s,r){const i={};r&1&&(i.config=s[0]),e.$set(i)},i(s){t||(k(e.$$.fragment,s),t=!0)},o(s){C(e.$$.fragment,s),t=!1},d(s){$(e,s)}}}function Ot(n){let e;return{c(){e=Te(n[0])},l(t){e=Me(t,n[0])},m(t,s){O(t,e,s)},p(t,s){s&1&&De(e,t[0])},i:J,o:J,d(t){t&&B(e)}}}function Vt(n){let e;return{c(){e=Te(n[1])},l(t){e=Me(t,n[1])},m(t,s){O(t,e,s)},p(t,s){s&2&&De(e,t[1])},i:J,o:J,d(t){t&&B(e)}}}function Gt(n){let e,t,s,r,i;const l=[Vt,Ot,Bt],o=[];function a(c,u){return u&1&&(e=null),e==null&&(e=!!_e(c[0])),e?0:typeof c[0]!="object"?1:2}return t=a(n,-1),s=o[t]=l[t](n),{c(){s.c(),r=E()},l(c){s.l(c),r=E()},m(c,u){o[t].m(c,u),O(c,r,u),i=!0},p(c,[u]){let d=t;t=a(c,u),t===d?o[t].p(c,u):(K(),C(o[d],1,1,()=>{o[d]=null}),L(),s=o[t],s?s.p(c,u):(s=o[t]=l[t](c),s.c()),k(s,1),s.m(r.parentNode,r))},i(c){i||(k(s),i=!0)},o(c){C(s),i=!1},d(c){c&&B(r),o[t].d(c)}}}function zt(n,e,t){let s,{of:r}=e;const i=_e(r)?r:jt;return Pe(n,i,l=>t(1,s=l)),n.$$set=l=>{"of"in l&&t(0,r=l.of)},[r,s,i]}class Nt extends te{constructor(e){super(),se(this,e,zt,Gt,ee,{of:0})}}class Kt{constructor(e,t){_(this,"component");_(this,"props");_(this,"eventHandlers",[]);_(this,"children",[]);this.component=e,this.props=t}on(e,t){return this.eventHandlers.push([e,t]),this}slot(...e){return this.children=e,this}}function ks(n,e){return new Kt(n,e)}class Ge{constructor({header:e,footer:t,height:s,plugins:r}){_(this,"header");_(this,"footer");_(this,"height");_(this,"plugins");this.header=e,this.footer=t,this.height=s,this.plugins=r}isFlat(){return"__flat"in this}isData(){return"__data"in this}isDisplay(){return"__display"in this}isGroup(){return"__group"in this}}class ze extends Ge{constructor({header:t,footer:s,plugins:r,id:i}){super({header:t,footer:s,plugins:r,height:1});_(this,"__flat",!0);_(this,"id");this.id=i??String(t)}}class Lt extends ze{constructor({header:t,footer:s,plugins:r,cell:i,accessor:l,id:o}){super({header:t,footer:s,plugins:r,id:"Initialization not complete"});_(this,"__data",!0);_(this,"cell");_(this,"accessorKey");_(this,"accessorFn");if(this.cell=i,l instanceof Function?this.accessorFn=l:this.accessorKey=l,o===void 0&&this.accessorKey===void 0&&t===void 0)throw new Error("A column id, string accessor, or header is required");const a=typeof this.accessorKey=="string"?this.accessorKey:null;this.id=o??a??String(t)}getValue(t){if(this.accessorFn!==void 0)return this.accessorFn(t);if(this.accessorKey!==void 0)return t[this.accessorKey]}}class Ut extends ze{constructor({header:t,footer:s,plugins:r,id:i,cell:l,data:o}){super({header:t,footer:s,plugins:r,id:i});_(this,"__display",!0);_(this,"cell");_(this,"data");this.cell=l,this.data=o}}class Wt extends Ge{constructor({header:t,footer:s,columns:r,plugins:i}){const l=Math.max(...r.map(o=>o.height))+1;super({header:t,footer:s,height:l,plugins:i});_(this,"__group",!0);_(this,"columns");_(this,"ids");this.columns=r,this.ids=Ne(r)}}const Ne=n=>n.flatMap(e=>e.isFlat()?[e.id]:e.isGroup()?e.ids:[]),Ke=n=>n.flatMap(e=>e.isFlat()?[e]:e.isGroup()?Ke(e.columns):[]),qt=n=>{const e=new Map;return n.forEach(t=>{e.set(t,(e.get(t)??0)+1)}),e},Zt=n=>Array.from(qt(n).entries()).filter(([,e])=>e!==1).map(([e])=>e),xt=n=>Object.entries(n).map(([e,t])=>`${e}:${t}`).join(";"),Yt=(n,e)=>n.style===void 0&&e.style===void 0?{...n,...e}:{...n,...e,style:{...typeof n.style=="object"?n.style:{},...typeof e.style=="object"?e.style:{}}},q=n=>n.style===void 0||typeof n.style!="object"?n:{...n,style:xt(n.style)};class ne{constructor({id:e}){_(this,"id");_(this,"attrsForName",{});_(this,"propsForName",{});_(this,"state");this.id=e}attrs(){return w(Object.values(this.attrsForName),e=>{let t={};return e.forEach(s=>{t=Yt(t,s)}),q(t)})}props(){return Oe(this.propsForName)}injectState(e){this.state=e}applyHook(e,t){t.props!==void 0&&(this.propsForName[e]=t.props),t.attrs!==void 0&&(this.attrsForName[e]=t.attrs)}}class Le extends ne{constructor({id:t,row:s}){super({id:t});_(this,"row");this.row=s}attrs(){return w(super.attrs(),t=>({...t,role:"cell"}))}rowColId(){return`${this.row.id}:${this.column.id}`}dataRowColId(){if(this.row.isData())return`${this.row.dataId}:${this.column.id}`}isData(){return"__data"in this}isDisplay(){return"__display"in this}}class ge extends Le{constructor({row:t,column:s,label:r,value:i}){super({id:s.id,row:t});_(this,"__data",!0);_(this,"column");_(this,"label");_(this,"value");this.column=s,this.label=r,this.value=i}render(){if(this.label===void 0)return`${this.value}`;if(this.state===void 0)throw new Error("Missing `state` reference");return this.label(this,this.state)}clone(){return new ge({row:this.row,column:this.column,label:this.label,value:this.value})}}class be extends Le{constructor({row:t,column:s,label:r}){super({id:s.id,row:t});_(this,"__display",!0);_(this,"column");_(this,"label");this.column=s,this.label=r}render(){if(this.state===void 0)throw new Error("Missing `state` reference");return this.label(this,this.state)}clone(){return new be({row:this.row,column:this.column,label:this.label})}}const Ee=n=>n!==null,T=n=>n!==void 0;class Jt extends ne{constructor({id:t,cells:s,cellForId:r,depth:i=0,parentRow:l}){super({id:t});_(this,"cells");_(this,"cellForId");_(this,"depth");_(this,"parentRow");_(this,"subRows");this.cells=s,this.cellForId=r,this.depth=i,this.parentRow=l}attrs(){return w(super.attrs(),t=>({...t,role:"row"}))}isData(){return"__data"in this}isDisplay(){return"__display"in this}}class me extends Jt{constructor({id:t,dataId:s,original:r,cells:i,cellForId:l,depth:o=0,parentRow:a}){super({id:t,cells:i,cellForId:l,depth:o,parentRow:a});_(this,"__data",!0);_(this,"dataId");_(this,"original");this.dataId=s,this.original=r}clone({includeCells:t=!1,includeSubRows:s=!1}={}){var i;const r=new me({id:this.id,dataId:this.dataId,cellForId:this.cellForId,cells:this.cells,original:this.original,depth:this.depth});if(t){const l=Object.fromEntries(Object.entries(r.cellForId).map(([a,c])=>{const u=c.clone();return u.row=r,[a,u]})),o=r.cells.map(({id:a})=>l[a]);r.cellForId=l,r.cells=o}if(s){const l=(i=this.subRows)==null?void 0:i.map(o=>o.clone({includeCells:t,includeSubRows:s}));r.subRows=l}else r.subRows=this.subRows;return r}}const Qt=(n,e,{rowDataId:t}={})=>{const s=n.map((r,i)=>{const l=i.toString();return new me({id:l,dataId:t!==void 0?t(r,i):l,original:r,cells:[],cellForId:{}})});return n.forEach((r,i)=>{const l=e.map(o=>{if(o.isData()){const a=o,c=a.getValue(r);return new ge({row:s[i],column:a,label:o.cell,value:c})}if(o.isDisplay()){const a=o;return new be({row:s[i],column:a,label:o.cell})}throw new Error("Unrecognized `FlatColumn` implementation")});s[i].cells=l,e.forEach((o,a)=>{s[i].cellForId[o.id]=l[a]})}),s},Xt=(n,e)=>{const t=n.map(s=>{const r=s.clone();return r.cells=[],r.cellForId={},r});return n.length===0||e.length===0?n:(n.forEach((s,r)=>{const i=s.cells.map(o=>{const a=o.clone();return a.row=t[r],a}),l=e.map(o=>i.find(a=>a.id===o)).filter(T);t[r].cells=l,i.forEach(o=>{t[r].cellForId[o.id]=o})}),t)},Ue=" ";class We extends ne{constructor({id:t,label:s,colspan:r,colstart:i}){super({id:t});_(this,"label");_(this,"colspan");_(this,"colstart");this.label=s,this.colspan=r,this.colstart=i}render(){if(this.label instanceof Function){if(this.state===void 0)throw new Error("Missing `state` reference");return this.label(this,this.state)}return this.label}attrs(){return w(super.attrs(),t=>({...t,role:"columnheader",colspan:this.colspan}))}isFlat(){return"__flat"in this}isData(){return"__data"in this}isFlatDisplay(){return"__flat"in this&&"__display"in this}isGroup(){return"__group"in this}isGroupDisplay(){return"__group"in this&&"__display"in this}}class re extends We{constructor({id:t,label:s,colstart:r}){super({id:t,label:s,colspan:1,colstart:r});_(this,"__flat",!0)}clone(){return new re({id:this.id,label:this.label,colstart:this.colstart})}}class we extends re{constructor({id:t,label:s,accessorKey:r,accessorFn:i,colstart:l}){super({id:t,label:s,colstart:l});_(this,"__data",!0);_(this,"accessorKey");_(this,"accessorFn");this.accessorKey=r,this.accessorFn=i}clone(){return new we({id:this.id,label:this.label,accessorFn:this.accessorFn,accessorKey:this.accessorKey,colstart:this.colstart})}}class oe extends re{constructor({id:t,label:s=Ue,colstart:r}){super({id:t,label:s,colstart:r});_(this,"__display",!0)}clone(){return new oe({id:this.id,label:this.label,colstart:this.colstart})}}class ie extends We{constructor({label:t,ids:s,allIds:r,colspan:i,colstart:l}){super({id:`[${s.join(",")}]`,label:t,colspan:i,colstart:l});_(this,"__group",!0);_(this,"ids");_(this,"allId");_(this,"allIds");this.ids=s,this.allId=`[${r.join(",")}]`,this.allIds=r}setIds(t){this.ids=t,this.id=`[${this.ids.join(",")}]`}pushId(t){this.ids=[...this.ids,t],this.id=`[${this.ids.join(",")}]`}clone(){return new ie({label:this.label,ids:this.ids,allIds:this.allIds,colspan:this.colspan,colstart:this.colstart})}}class Re extends ie{constructor({label:t=Ue,ids:s,allIds:r,colspan:i=1,colstart:l}){super({label:t,ids:s,allIds:r,colspan:i,colstart:l});_(this,"__display",!0)}clone(){return new Re({label:this.label,ids:this.ids,allIds:this.allIds,colspan:this.colspan,colstart:this.colstart})}}const es=n=>n.reduce((e,t)=>e+t,0),qe=(n,e)=>{const t=[];for(let s=0;s<e;s++)t.push(Array(n).fill(null));return t},je=n=>{const e=n.length;if(e===0)return n;const t=n[0].length,s=qe(e,t);for(let r=0;r<t;r++)for(let i=0;i<e;i++)s[r][i]=n[i][r];return s};class ye extends ne{constructor({id:t,cells:s}){super({id:t});_(this,"cells");this.cells=s}attrs(){return w(super.attrs(),t=>({...t,role:"row"}))}clone(){return new ye({id:this.id,cells:this.cells})}}const ts=(n,e=[])=>{const t=ss(n);let s=je(t);return s=ns(s,e),rs(s),os(je(s))},ss=n=>{const e=es(n.map(i=>i.isGroup()?i.ids.length:1)),t=Math.max(...n.map(i=>i.height)),s=qe(e,t);let r=0;return n.forEach(i=>{const l=t-i.height;Ze(s,i,l,r),r+=i.isGroup()?i.ids.length:1}),s.map((i,l)=>i.map((o,a)=>{var u;if(o!==null)return o;if(l===t-1)return new oe({id:a.toString(),colstart:a});const c=((u=s[t-1][a])==null?void 0:u.id)??a.toString();return new Re({ids:[],allIds:[c],colstart:a})}))},Ze=(n,e,t,s)=>{if(e.isData()){n[n.length-1][s]=new we({label:e.header,accessorFn:e.accessorFn,accessorKey:e.accessorKey,id:e.id,colstart:s});return}if(e.isDisplay()){n[n.length-1][s]=new oe({id:e.id,label:e.header,colstart:s});return}if(e.isGroup()){for(let i=0;i<e.ids.length;i++)n[t][s+i]=new ie({label:e.header,colspan:1,allIds:e.ids,ids:[],colstart:s});let r=0;e.columns.forEach(i=>{Ze(n,i,t+1,s+r),r+=i.isGroup()?i.ids.length:1});return}},ns=(n,e)=>{if(e.length===0)return n;const t=[];return e.forEach((s,r)=>{const i=n.find(l=>{const o=l[l.length-1];if(!o.isFlat())throw new Error("The last element of each column must be a `FlatHeaderCell`");return o.id===s});i!==void 0&&t.push(i.map(l=>{const o=l.clone();return o.colstart=r,o}))}),t},rs=n=>{n.forEach(e=>{const t=e[e.length-1];if(!t.isFlat())throw new Error("The last element of each column must be a `FlatHeaderCell`");e.forEach(s=>{s.isGroup()&&s.pushId(t.id)})})},os=n=>n.map((e,t)=>new ye({id:t.toString(),cells:is(e)})),is=n=>{if(n.length===0)return n;const e=[];let t=0,s=1;for(;t<n.length;){const r=n[t].clone();if(!r.isGroup()){e.push(r),t++;continue}s=t+1;const i=[...r.ids];for(;s<n.length;){const l=n[s];if(!l.isGroup()||r.allId!==l.allId)break;i.push(...l.ids),s++}r.setIds(i),r.colspan=s-t,e.push(r),t=s}return e},ls=(n,e,{rowDataId:t}={})=>{const{data:s,plugins:r}=n,i=Ke(e),l=G(i),o=w([s,l],([b,y])=>Qt(b,y,{rowDataId:t})),a=S([]),c=S(),u=S([]),d=S([]),m=S({role:"table"}),p=S({}),f=S({role:"rowgroup"}),g={data:s,columns:e,flatColumns:i,tableAttrs:m,tableHeadAttrs:p,tableBodyAttrs:f,visibleColumns:a,headerRows:c,originalRows:o,rows:u,pageRows:d},h=Object.fromEntries(Object.entries(r).map(([b,y])=>{const v=Object.fromEntries(i.map(I=>{var j;const A=(j=I.plugins)==null?void 0:j[b];if(A!==void 0)return[I.id,A]}).filter(T));return[b,y({pluginName:b,tableState:g,columnOptions:v})]})),F=Object.fromEntries(Object.entries(h).map(([b,y])=>[b,y.pluginState])),R={data:s,columns:e,flatColumns:i,tableAttrs:m,tableHeadAttrs:p,tableBodyAttrs:f,visibleColumns:a,headerRows:c,originalRows:o,rows:u,pageRows:d,pluginStates:F},D=Object.values(h).map(b=>b.deriveTableAttrs).filter(T);let le=G({role:"table"});D.forEach(b=>{le=b(le)});const et=w(le,b=>{const y=q(b);return m.set(y),y}),tt=Object.values(h).map(b=>b.deriveTableBodyAttrs).filter(T);let ae=G({});tt.forEach(b=>{ae=b(ae)});const st=w(ae,b=>{const y=q(b);return p.set(y),y}),nt=Object.values(h).map(b=>b.deriveTableBodyAttrs).filter(T);let ce=G({role:"rowgroup"});nt.forEach(b=>{ce=b(ce)});const rt=w(ce,b=>{const y=q(b);return f.set(y),y}),ot=Object.values(h).map(b=>b.deriveFlatColumns).filter(T);let ue=l;ot.forEach(b=>{ue=b(ue)});const de=w(ue,b=>(a.set(b),b)),it=w([o,de],([b,y])=>Xt(b,y.map(v=>v.id))),lt=Object.values(h).map(b=>b.deriveRows).filter(T);let fe=it;lt.forEach(b=>{fe=b(fe)});const Fe=w(fe,b=>(b.forEach(y=>{y.injectState(R),y.cells.forEach(v=>{v.injectState(R)})}),Object.entries(h).forEach(([y,v])=>{b.forEach(I=>{var A;((A=v.hooks)==null?void 0:A["tbody.tr"])!==void 0&&I.applyHook(y,v.hooks["tbody.tr"](I)),I.cells.forEach(j=>{var M;((M=v.hooks)==null?void 0:M["tbody.tr.td"])!==void 0&&j.applyHook(y,v.hooks["tbody.tr.td"](j))})})}),u.set(b),b)),at=Object.values(h).map(b=>b.derivePageRows).filter(T);let pe=Fe;at.forEach(b=>{pe=b(pe)});const ct=w(pe,b=>(b.forEach(y=>{y.injectState(R),y.cells.forEach(v=>{v.injectState(R)})}),Object.entries(h).forEach(([y,v])=>{b.forEach(I=>{var A;((A=v.hooks)==null?void 0:A["tbody.tr"])!==void 0&&I.applyHook(y,v.hooks["tbody.tr"](I)),I.cells.forEach(j=>{var M;((M=v.hooks)==null?void 0:M["tbody.tr.td"])!==void 0&&j.applyHook(y,v.hooks["tbody.tr.td"](j))})})}),d.set(b),b)),ut=w(de,b=>{const y=ts(e,b.map(v=>v.id));return y.forEach(v=>{v.injectState(R),v.cells.forEach(I=>{I.injectState(R)})}),Object.entries(h).forEach(([v,I])=>{y.forEach(A=>{var j;((j=I.hooks)==null?void 0:j["thead.tr"])!==void 0&&A.applyHook(v,I.hooks["thead.tr"](A)),A.cells.forEach(M=>{var ve;((ve=I.hooks)==null?void 0:ve["thead.tr.th"])!==void 0&&M.applyHook(v,I.hooks["thead.tr.th"](M))})})}),c.set(y),y});return{tableAttrs:et,tableHeadAttrs:st,tableBodyAttrs:rt,visibleColumns:de,flatColumns:i,headerRows:ut,originalRows:o,rows:Fe,pageRows:ct,pluginStates:F}};class as{constructor(e,t){_(this,"data");_(this,"plugins");this.data=e,this.plugins=t}createColumns(e){const t=Ne(e),s=Zt(t);if(s.length!==0)throw new Error(`Duplicate column ids not allowed: "${s.join('", "')}"`);return e}column(e){return new Lt(e)}group(e){return new Wt(e)}display(e){return new Ut(e)}createViewModel(e,t){return ls(this,e,t)}}const Cs=(n,e={})=>new as(n,e),cs=n=>{let e=n.replace(/\[(\d+)\]/g,".$1");return e.startsWith(".")&&(e=e.slice(1)),e.split(".")},W=(n,e)=>{let t=n;for(const s of e){if(t==null)return;t=t[s]}return t},$e=n=>{const e=Object.create(n);return Object.assign(e,n),e};function us(n,e){const t=cs(e);if(t.some(a=>a==="__proto__"))throw new Error('key cannot include "__proto__"');const s=t.slice(0,t.length-1),r=t[t.length-1],i=w(n,a=>W(a,t)),l=a=>{n.update(c=>{if(c==null)return c;const u=Array.isArray(c)?[...c]:$e(c);return W(u,s)[r]=a,u})},o=a=>{n.update(c=>{if(c==null)return c;const u=a(W(c,t)),d=Array.isArray(c)?[...c]:$e(c);return W(d,s)[r]=u,d})};return{subscribe:i.subscribe,set:l,update:o}}const xe=(n,e,t)=>n.map(r=>{const{subRows:i}=r;if(i===void 0)return r;const l=xe(i,e,t),o=r.clone();return o.subRows=l,o}).filter(r=>{var i;if((((i=r.subRows)==null?void 0:i.length)??0)!==0)return!0;for(const[l,o]of Object.entries(t)){const a=r.cellForId[l];if(!a.isData())continue;const{value:c}=a,u=e[l];if(u===void 0)continue;if(!o.fn({value:c,filterValue:u}))return!1}return!0}),Is=({serverSide:n=!1}={})=>({columnOptions:e,tableState:t})=>{const s=S({}),r=S([]),i=S([]);return{pluginState:{filterValues:s,preFilteredRows:r},deriveRows:a=>w([a,s],([c,u])=>{if(r.set(c),n)return i.set(c),c;const d=xe(c,u,e);return i.set(d),d}),hooks:{"thead.tr.th":a=>{const c=us(s,a.id);return{props:w([],()=>{var g;const d=e[a.id];if(d===void 0)return;c.set(d.initialFilterValue);const m=w(r,h=>a.isData()?h.map(F=>{const R=F.cellForId[a.id];return R==null?void 0:R.value}):[]),p=w(i,h=>a.isData()?h.map(F=>{const R=F.cellForId[a.id];return R==null?void 0:R.value}):[]);return{render:(g=d.render)==null?void 0:g.call(d,{id:a.id,filterValue:c,...t,values:p,preFilteredRows:r,preFilteredValues:m})}})}}}}},ds=({filterValue:n,value:e})=>n===""?!0:String(e).toLowerCase().startsWith(String(n).toLowerCase());G(void 0);const Ye=(n={})=>{const e=m=>Object.fromEntries(Object.entries(m).filter(([,p])=>p)),{subscribe:t,update:s,set:r}=S(e(n)),i=m=>{s(p=>{const f=m(p);return e(f)})};return{subscribe:t,update:i,set:m=>i(()=>m),toggle:m=>{s(p=>p[m]===!0?(delete p[m],p):{...p,[m]:!0})},add:m=>{s(p=>({...p,[m]:!0}))},addAll:m=>{s(p=>({...p,...Object.fromEntries(m.map(f=>[f,!0]))}))},remove:m=>{s(p=>(delete p[m],p))},removeAll:m=>{s(p=>{for(const f of m)delete p[f];return p})},clear:()=>{r({})}}},fs=n=>n instanceof MouseEvent?n.shiftKey:!1,As=({initialHiddenColumnIds:n=[]}={})=>()=>{const e=S(n);return{pluginState:{hiddenColumnIds:e},deriveFlatColumns:r=>w([r,e],([i,l])=>l.length===0?i:i.filter(o=>!l.includes(o.id)))}},ps=1,hs=({items:n,initialPageSize:e,initialPageIndex:t,serverSide:s,serverItemCount:r})=>{const i=S(e),l=p=>{i.update(f=>{const g=p(f);return Math.max(g,ps)})},o=p=>l(()=>p),a=S(t);function c([p,f]){const g=Math.ceil(f/p);return a.update(h=>g>0&&h>=g?g-1:h),g}let u;if(s&&r!=null)u=w([i,r],c);else{const p=w(n,f=>f.length);u=w([i,p],c)}const d=w(a,p=>p>0),m=w([a,u],([p,f])=>p<f-1);return{pageSize:{subscribe:i.subscribe,update:l,set:o},pageIndex:a,pageCount:u,serverItemCount:r,hasPreviousPage:d,hasNextPage:m}},Es=({initialPageIndex:n=0,initialPageSize:e=10,serverSide:t=!1,serverItemCount:s}={})=>()=>{const r=S([]),i=S([]),{pageSize:l,pageIndex:o,pageCount:a,hasPreviousPage:c,hasNextPage:u}=hs({items:r,initialPageIndex:n,initialPageSize:e,serverSide:t,serverItemCount:s});return{pluginState:{pageSize:l,pageIndex:o,pageCount:a,hasPreviousPage:c,hasNextPage:u},derivePageRows:p=>w([p,l,o],([f,g,h])=>{if(r.set(f),t)return i.set(f),f;const F=h*g,R=f.slice(F,F+g);return i.set(R),R})}},z=(n,e,t)=>n.isData()&&(!t||n.subRows===void 0)?e[n.dataId]===!0:n.subRows===void 0?!1:n.subRows.every(s=>z(s,e,t)),he=(n,e,t)=>n.isData()&&(!t||n.subRows===void 0)?e[n.dataId]===!0:n.subRows===void 0?!1:n.subRows.some(s=>he(s,e,t)),Je=(n,e,t,s)=>{n.isData()&&(t[n.dataId]=e,!s)||n.subRows!==void 0&&n.subRows.forEach(r=>{Je(r,e,t,s)})},_s=(n,e,t)=>{const{subscribe:s}=w(e,l=>{if(n.isData()){if(!t)return l[n.dataId]===!0;if(l[n.dataId]===!0)return!0}return z(n,l,t)}),r=l=>{e.update(o=>{const a=z(n,o,t),c={...o};return Je(n,l(a),c,t),n.parentRow!==void 0&&n.parentRow.isData()&&(c[n.parentRow.dataId]=z(n.parentRow,c,t)),c})};return{subscribe:s,update:r,set:l=>r(()=>l)}},js=({initialSelectedDataIds:n={},linkDataSubRows:e=!0}={})=>({tableState:t})=>{const s=Ye(n),r=f=>{const g=_s(f,s,e),h=w([g,s],([R,D])=>R?!1:he(f,D,e)),F=w(s,R=>z(f,R,e));return{isSelected:g,isSomeSubRowsSelected:h,isAllSubRowsSelected:F}},i=w([t.rows,s],([f,g])=>f.every(h=>h.isData()?g[h.dataId]===!0:!0)),l=f=>{if(f){const h=U(t.rows).map(F=>F.isData()?F.dataId:null).filter(Ee);s.addAll(h)}else s.clear()},o={subscribe:i.subscribe,update(f){const g=U(i);l(f(g))},set:l},a=w([t.rows,s],([f,g])=>f.some(h=>h.isData()?g[h.dataId]===!0:!1)),c=w([t.pageRows,s],([f,g])=>f.every(h=>h.isData()?g[h.dataId]===!0:!0)),u=f=>{const h=U(t.pageRows).map(F=>F.isData()?F.dataId:null).filter(Ee);f?s.addAll(h):s.removeAll(h)},d={subscribe:c.subscribe,update(f){const g=U(c);u(f(g))},set:u},m=w([t.pageRows,s],([f,g])=>f.some(h=>h.isData()?g[h.dataId]===!0:!1));return{pluginState:{selectedDataIds:s,getRowState:r,allRowsSelected:o,someRowsSelected:a,allPageRowsSelected:d,somePageRowsSelected:m},hooks:{"tbody.tr":f=>({props:w(s,h=>{const F=he(f,h,e),R=z(f,h,e);return{selected:f.isData()?h[f.dataId]===!0:R,someSubRowsSelected:F,allSubRowsSelected:R}})})}}},Z=(n,e)=>Array.isArray(n)&&Array.isArray(e)?gs(n,e):typeof n=="number"&&typeof e=="number"?n-e:n<e?-1:n>e?1:0,gs=(n,e)=>{const t=Math.min(n.length,e.length);for(let s=0;s<t;s++){const r=Z(n[s],e[s]);if(r!==0)return r}return 0},bs=["asc","desc",void 0],ms=n=>{const{subscribe:e,update:t,set:s}=S(n);return{subscribe:e,update:t,set:s,toggleId:(l,{multiSort:o=!0,toggleOrder:a=bs}={})=>{t(c=>{const u=c.findIndex(h=>h.id===l),d=c[u],m=d==null?void 0:d.order,f=(a.findIndex(h=>h===m)+1)%a.length,g=a[f];return o?u===-1&&g!==void 0?[...c,{id:l,order:g}]:g===void 0?[...c.slice(0,u),...c.slice(u+1)]:[...c.slice(0,u),{id:l,order:g},...c.slice(u+1)]:g===void 0?[]:[{id:l,order:g}]})},clearId:l=>{t(o=>{const a=o.findIndex(c=>c.id===l);return a===-1?o:[...o.slice(0,a),...o.slice(a+1)]})}}},Qe=(n,e,t)=>{const s=[...n];s.sort((r,i)=>{var l,o,a;for(const c of e){const u=((l=t[c.id])==null?void 0:l.invert)??!1,d=r.cellForId[c.id],m=i.cellForId[c.id];let p=0;const f=(o=t[c.id])==null?void 0:o.compareFn,g=(a=t[c.id])==null?void 0:a.getSortValue;if(!d.isData())return 0;const h=d.value,F=m.value;if(f!==void 0)p=f(h,F);else if(g!==void 0){const R=g(h),D=g(F);p=Z(R,D)}else if(typeof h=="string"||typeof h=="number")p=Z(h,F);else if(h instanceof Date||F instanceof Date){const R=h instanceof Date?h.getTime():0,D=F instanceof Date?F.getTime():0;p=Z(R,D)}if(p!==0){let R=1;return c.order==="desc"&&(R*=-1),u&&(R*=-1),p*R}}return 0});for(let r=0;r<s.length;r++){const{subRows:i}=s[r];if(i===void 0)continue;const l=Qe(i,e,t),o=s[r].clone();o.subRows=l,s[r]=o}return s},$s=({initialSortKeys:n=[],disableMultiSort:e=!1,isMultiSortEvent:t=fs,toggleOrder:s,serverSide:r=!1}={})=>({columnOptions:i})=>{const l=Object.entries(i).filter(([,d])=>d.disable===!0).map(([d])=>d),o=ms(n),a=S([]);return{pluginState:{sortKeys:o,preSortedRows:a},deriveRows:d=>w([d,o],([m,p])=>(a.set(m),r?m:Qe(m,p,i))),hooks:{"thead.tr.th":d=>{const m=l.includes(d.id);return{props:w(o,f=>{const g=f.find(R=>R.id===d.id),h=R=>{d.isData()&&(m||o.toggleId(d.id,{multiSort:e?!1:t(R),toggleOrder:s}))},F=()=>{d.isData()&&(l.includes(d.id)||o.clearId(d.id))};return{order:g==null?void 0:g.order,toggle:h,clear:F,disabled:m}})}},"tbody.tr.td":d=>({props:w(o,p=>{const f=p.find(g=>g.id===d.id);return{order:f==null?void 0:f.order}})})}}},Xe=(n,e,t,{tableCellMatches:s,fn:r,includeHiddenColumns:i})=>n.map(o=>{const{subRows:a}=o;if(a===void 0)return o;const c=Xe(a,e,t,{tableCellMatches:s,fn:r,includeHiddenColumns:i}),u=o.clone();return u.subRows=c,u}).filter(o=>{var c;return(((c=o.subRows)==null?void 0:c.length)??0)!==0?!0:Object.values(o.cellForId).map(u=>{const d=t[u.id];if((d==null?void 0:d.exclude)===!0||o.cells.find(g=>g.id===u.id)===void 0&&!i||!u.isData())return!1;let p=u.value;(d==null?void 0:d.getFilterValue)!==void 0&&(p=d==null?void 0:d.getFilterValue(p));const f=r({value:String(p),filterValue:e});if(f){const g=u.dataRowColId();g!==void 0&&(s[g]=f)}return f}).includes(!0)}),Ps=({fn:n=ds,initialFilterValue:e="",includeHiddenColumns:t=!1,serverSide:s=!1}={})=>({columnOptions:r})=>{const i=S(e),l=S([]),o=Ye();return{pluginState:{filterValue:i,preFilteredRows:l},deriveRows:u=>w([u,i],([d,m])=>{l.set(d),o.clear();const p={},f=Xe(d,m,r,{tableCellMatches:p,fn:n,includeHiddenColumns:t});return o.set(p),s?d:f}),hooks:{"tbody.tr.td":u=>({props:w([i,o],([m,p])=>{const f=u.dataRowColId();return{matches:m!==""&&f!==void 0&&(p[f]??!1)}})})}}};export{Nt as R,St as S,As as a,js as b,Cs as c,Ps as d,Es as e,$s as f,ks as g,Is as h};
